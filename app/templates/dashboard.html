<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Dashboard - CSV → DAT Converter</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="/static/dashboard.css">
  </head>

  <body>
    <div class="dashboard-container">
      <div class="dashboard-header">
        <h1>CSV → DAT</h1>
        <small>Welcome, Lazy bums!</small>
      </div>

      <div class="choices">
        <!-- VAT Relief Accordion -->
        <div class="accordion-item">
          <button class="accordion-header" id="vatAccordion">
            <i class="fa-solid fa-file-invoice-dollar me-2"></i> VAT Relief
            <i class="fa-solid fa-chevron-down ms-2 accordion-icon"></i>
          </button>
          <div class="accordion-content">
            <button class="choice-btn sub-btn" id="salesBtn">
              <i class="fa-solid fa-chart-line me-2"></i> Sales
            </button>
            <button class="choice-btn sub-btn" id="purchasesBtn">
              <i class="fa-solid fa-cart-shopping me-2"></i> Purchases
            </button>
          </div>
        </div>

        <!-- SAWT Button -->
        <button class="choice-btn standalone-btn" id="sawtBtn">
          <i class="fa-solid fa-file-contract me-2"></i> SAWT
        </button>

        <!-- QAP Accordion -->
        <div class="accordion-item">
          <button class="accordion-header" id="qapAccordion">
            <i class="fa-solid fa-file-invoice-dollar me-2"></i> QAP
            <i class="fa-solid fa-chevron-down ms-2 accordion-icon"></i>
          </button>
          <div class="accordion-content">
            <button class="choice-btn sub-btn" id="quarterlyBtn">
              <i class="fa-solid fa-chart-line me-2"></i> 1601EQ
            </button>
            <button class="choice-btn sub-btn" id="annualBtn">
              <i class="fa-solid fa-cart-shopping me-2"></i> 1604E
            </button>
          </div>
        </div>

        <!-- 1604C Button -->
        <button class="choice-btn standalone-btn" id="compenBtn">
          <i class="fa-solid fa-file-contract me-2"></i> 1604C
        </button>
      </div>

      <div class="logout mt-4">
        <a href="/logout"><i class="fa-solid fa-right-from-bracket me-1"></i> Logout</a>
      </div>
    </div>

    <script>
        // Fade in on page load
        window.addEventListener("load", () => {
            document.body.classList.add("fade-in");
        });

        // Function for smooth redirect
        function smoothRedirect(url) {
            document.body.classList.remove("fade-in");
            document.body.classList.add("fade-out");
            setTimeout(() => {
                window.location.href = url;
            }, 400); // delay to match fade-out duration
        }

        // Accordion functionality
        document.querySelectorAll('.accordion-header').forEach(header => {
            header.addEventListener('click', () => {
                const accordionItem = header.parentElement;
                const accordionContent = header.nextElementSibling;
                const icon = header.querySelector('.accordion-icon');
                
                // Close all other accordions
                document.querySelectorAll('.accordion-item').forEach(item => {
                    if (item !== accordionItem) {
                        const otherContent = item.querySelector('.accordion-content');
                        const otherIcon = item.querySelector('.accordion-icon');
                        if (otherContent) {
                            otherContent.classList.remove('open');
                            otherContent.style.maxHeight = null;
                        }
                        if (otherIcon) {
                            otherIcon.style.transform = 'rotate(0deg)';
                        }
                    }
                });
                
                // Toggle current accordion
                if (accordionContent.classList.contains('open')) {
                    accordionContent.classList.remove('open');
                    accordionContent.style.maxHeight = null;
                    icon.style.transform = 'rotate(0deg)';
                } else {
                    accordionContent.classList.add('open');
                    accordionContent.style.maxHeight = accordionContent.scrollHeight + 'px';
                    icon.style.transform = 'rotate(180deg)';
                }
            });
        });

        // Close accordions when clicking outside
        document.addEventListener('click', (event) => {
            if (!event.target.closest('.accordion-item')) {
                document.querySelectorAll('.accordion-content').forEach(content => {
                    content.classList.remove('open');
                    content.style.maxHeight = null;
                });
                document.querySelectorAll('.accordion-icon').forEach(icon => {
                    icon.style.transform = 'rotate(0deg)';
                });
            }
        });

        // Redirects with fade transition
        document.getElementById("purchasesBtn").addEventListener("click", () => {
            smoothRedirect("/purchases");
        });
        
        document.getElementById("salesBtn").addEventListener("click", () => {
            smoothRedirect("/sales");
        });

        document.getElementById("quarterlyBtn").addEventListener("click", () => {
            smoothRedirect("/qap-quarterly");
        });

        document.getElementById("annualBtn").addEventListener("click", () => {
            smoothRedirect("/qap-annual");
        });

        document.getElementById("sawtBtn").addEventListener("click", () => {
            smoothRedirect("/sawt");
        });

        document.getElementById("compenBtn").addEventListener("click", () => {
            smoothRedirect("/compen");
        });
    </script>
  </body>
</html>