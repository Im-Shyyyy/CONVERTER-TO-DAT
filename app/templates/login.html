<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Login - CSV → DAT Converter</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="/static/login.css" />
  </head>

  <body>
    <div class="login-container">
      <div class="login-header">
        <h1>CSV → DAT</h1>
        <small>Welcome Back</small>
      </div>

      {% if error %}
      <div class="alert alert-danger py-2 mt-3 small">{{ error }}</div>
      {% endif %}

      <form method="POST" id="loginForm">
        <div class="input-group">
          <i class="fa fa-user"></i>
          <input
            type="text"
            name="username"
            id="username"
            class="form-control"
            placeholder="Username"
            required
          />
        </div>

        <div class="input-group">
          <i class="fa fa-lock"></i>
          <input
            type="password"
            name="password"
            id="password"
            class="form-control"
            placeholder="Password"
            required
          />
        </div>

        <button type="submit" class="btn btn-login mt-2">SIGN IN</button>
      </form>

      <div class="login-footer mt-3">
        <span>Don't have an account? <a href="#">Contact Leo</a></span>
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        
        // Add focus indicator styling
        const style = document.createElement('style');
        style.textContent = `
          .form-control:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(255, 0, 0, 0.25);
          }
          .form-control.focus-highlight {
            box-shadow: 0 0 0 3px rgba(255, 0, 0, 0.5) !important;
            border: 1px solid rgba(255, 0, 0, 0.3) !important;
          }
        `;
        document.head.appendChild(style);
        
        // Set initial focus to username
        usernameInput.focus();
        usernameInput.classList.add('focus-highlight');
        
        // Keyboard navigation
        document.addEventListener('keydown', function(event) {
          const activeElement = document.activeElement;
          const isUsernameFocused = activeElement === usernameInput;
          const isPasswordFocused = activeElement === passwordInput;
          
          // Remove highlight from all inputs
          usernameInput.classList.remove('focus-highlight');
          passwordInput.classList.remove('focus-highlight');
          
          // Add highlight to currently focused element
          if (isUsernameFocused) {
            usernameInput.classList.add('focus-highlight');
          } else if (isPasswordFocused) {
            passwordInput.classList.add('focus-highlight');
          }
          
          // Handle arrow key navigation
          if (event.key === 'ArrowDown' || event.key === 'ArrowRight') {
            event.preventDefault(); // Prevent scrolling
            if (isUsernameFocused) {
              passwordInput.focus();
              passwordInput.classList.add('focus-highlight');
            } else if (isPasswordFocused) {
              // If at password, go to submit button
              document.querySelector('.btn-login').focus();
            }
          }
          
          if (event.key === 'ArrowUp' || event.key === 'ArrowLeft') {
            event.preventDefault(); // Prevent scrolling
            if (isPasswordFocused) {
              usernameInput.focus();
              usernameInput.classList.add('focus-highlight');
            } else if (document.activeElement.classList.contains('btn-login')) {
              // If at submit button, go to password
              passwordInput.focus();
              passwordInput.classList.add('focus-highlight');
            }
          }
          
          // Tab key still works normally, but we'll add highlight
          if (event.key === 'Tab') {
            // Add slight delay to let the browser focus the next element first
            setTimeout(() => {
              const focused = document.activeElement;
              if (focused === usernameInput || focused === passwordInput) {
                focused.classList.add('focus-highlight');
              }
            }, 10);
          }
        });
        
        // Also handle focus events for mouse/touch
        usernameInput.addEventListener('focus', () => {
          usernameInput.classList.add('focus-highlight');
          passwordInput.classList.remove('focus-highlight');
        });
        
        passwordInput.addEventListener('focus', () => {
          passwordInput.classList.add('focus-highlight');
          usernameInput.classList.remove('focus-highlight');
        });
        
        // Handle blur to remove highlight when clicking outside
        usernameInput.addEventListener('blur', () => {
          if (document.activeElement !== passwordInput) {
            usernameInput.classList.remove('focus-highlight');
          }
        });
        
        passwordInput.addEventListener('blur', () => {
          if (document.activeElement !== usernameInput) {
            passwordInput.classList.remove('focus-highlight');
          }
        });
      });
    </script>
  </body>
</html>